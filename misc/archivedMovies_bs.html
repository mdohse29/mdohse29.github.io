<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archived Movies BS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link rel="stylesheet" href="amStyle_bs.css">
    <script>


        $.get('./archive.txt', function(data, status){
          let movies = data.split('\n');
          if (movies.length > 0){
            $('p[id="placeH"]').remove();
          }
          for (a = 0; a < movies.length; a++){
            $('.movies').append('<p class="title" style="background-color: none;font-weight: bold;font-size: 1em;">' + movies[a].replaceAll('.', ' ') + '</p>');
          }
        }, 'text');
          
    
      </script>
      <script>
        $(document).ready(function(){
          //Not sure why but I was looking at multiple events on one element, useful?
          let previous = document.referrer;
          if (previous.includes("toolBox.html")){
              $('#toolBox').removeClass('d-none');
          }
    
          $('#search-box').on("keydown", function(event){
            // click submit when the enter/return key is pressed in the search-box
            if (event.which == 13){
              document.getElementById('submit-search').click();
            }
          });
    
          $('#submit-search').click(function(){
            var searchText = $('#search-box').val();
            var found = false;
            if (searchText == "" || searchText == null){
              window.alert("Please enter a title to search.");
            }else{
              var elements = $('.movies > p.title');
              // window.alert(elements.length);
              var titles = [];
              
              for (a = 0; a < elements.length; a++){
                titles.push(elements[a].innerText);
              }
    
            //   $('.movies').css('display','none');
            //   $('.results').css('display', 'block');
              $('.movies').addClass('d-none');
              $('.results').removeClass('d-none');
              $('.results > .title').remove();
    
              // window.alert(titles.length);
              for (a in titles){
                if (titles[a].toLowerCase().includes(searchText.toLowerCase())){
                  $('.results').append('<p class="title" style="background-color: none;font-weight: bold;font-size: 1em;">' + titles[a] + '</p>');
                  found = true;
                }
              }
              if (!found){
                $('.results').append('<p class="notFound">Sorry! We could not find what you are looking for. Check Emby to see if it is already active. If not, make a request for what movie you would like to see, and I will try to download it.</p>');
              }
    
              $('#search-box').attr('disabled', '');
              $('#submit-search').text("Reset");
              $('#submit-search').attr('id', 'search-reset');
              $('#search-reset').attr('onclick', 'reset();');
    
    
            }
          });
    
          reset = function(){
            $('#search-box').removeAttr('disabled');
            $('#search-box').val('');
            $('#search-reset').removeAttr('onclick');
            // $('.results').css('display', 'none');
            // $('.movies').css('display','block');
            $('.results').addClass('d-none');
            $('.movies').removeClass('d-none');
            $('.results > p').remove();
            $('#search-reset').text("Submit");
            $('#search-reset').attr('id', 'submit-search');
    
          }
    
          // setTimeout(function(){
            $(document).on('mouseenter', 'p.title', function(){
              $(this).css('background-color', 'black');
              $(this).css('color', 'white');
              $(this).css('font-size', '1.25em');
              $(this).css('font-weight', 'normal');
            });
            $(document).on('mouseleave', 'p.title', function(){
              $(this).css('background-color', 'inherit');
              $(this).css('color', 'black');
              $(this).css('font-size', '1em');
              $(this).css('font-weight', 'bold');
            });
          // }, 500);
        });
      </script>

</head>
<body style="background-color: lightblue;">
    <div class="container-fluid">
        <div class="row">
            <div class="col-4 mt-2 search">
            <input type="text" name="q" class="w-50" id="search-box" placeholder="Search Title Here">
            <button class="btn btn-sm btn-info" id="submit-search">Submit</button>
            </div>
            <div class="head col-4">
            <h1 style="text-align:center;">Archived Movies</h1>
            </div>
            <div id="toolBox" class="col d-none"><a href="../toolBox.html">Back to ToolBox</a></div>
        </div>
        <div class="row">
           <div class="col movies">
            <p id="placeH" style="text-align: center;font-size: 1.5em;">OOPS! Something Went Wrong!<br><br>Nothing to see here</p>
            </div>
            <div class="col d-none results">
        
            </div>
             <div class="msg col">
            <p>If there is a movie in this list you would like to see,<br>just let me know and I will add it to the server.<br><a href="mailto:mdohse30@gmail.com">mdohse30@gmail.com</a></p>
        
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
  </body>
</html>